/// Um agendamento prévio deve validar se o médico está disponível na data e hora marcada:
/// Para esse regra devemos validar se o médico possui uma escala para a data e hora marcada 
/// e se ele não possui outro agendamento para a mesma data e hora

/// Um agendamento instantâneo deve, a partir do ScheduleType.immediate filtrar os médicos que possuem escala de plantão
/// e os que não possuem agendamento para a mesma data e hora

enum ScheduleType {
    previously
    immediate
}

enum ScheduleStatus {
    scheduled
    confirmed
    canceled
    consulted
}

/// 
/// Schedule
/// 
model Schedule {
    id     Int            @id @default(autoincrement())
    date   DateTime       @default(now())
    type   ScheduleType
    status ScheduleStatus

    // Pacient
    pacient   Pacient @relation(fields: [pacientId], references: [id])
    pacientId Int

    // healthPrefessional
    healthPrefessional   HealthProfessional @relation(fields: [healthPrefessionalId], references: [id])
    healthPrefessionalId Int

    // Consultation History
    consultationHistory ConsultationHistory?

    // Audit fields
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isActive  Boolean  @default(true)

    // Registered by recepcionist
    recepcionist   Recepcionist? @relation(fields: [recepcionistId], references: [id])
    recepcionistId Int?

    // Registered by admin
    admin   Admin? @relation(fields: [adminId], references: [id])
    adminId Int?

    @@unique([date, healthPrefessionalId])
}
